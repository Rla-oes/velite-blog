---
title: "[LG Aimers] Casuality"
description: "인과추론 정리"
date: 2025-07-12
published: true
tags: ["LG Aimers", "Mathematics"]
---

> 본 포스팅은 LG Aimers 7기 Phase 1 강의 내용을 정리한 글입니다. 모든 출처는 LG Aimers에 있습니다.
---

## **Part I – 인과추론의 기초 개념**

### 1. **왜 인과추론(Causality)을 배우는가?**

* 과학의 핵심은 **법칙**을 발견하는 것. 법칙은 결국 **인과 메커니즘**임.
* 인과는 물리학·심리학·경제학·의학·공학 등 거의 모든 분야에서 중요.
* 단순히 연관(correlation)을 아는 것과, 원인(cause)을 아는 것은 **질적으로 다르다**.

> 예시: "흡연자 중 폐암 발생률이 높다" → 연관 관계
> 하지만 "흡연이 폐암의 원인이다" → 인과 관계 (→ 정책 개입 가능)

---

### 2. **Pearl의 인과 계층 (Causal Hierarchy)**

* **Level 1: 관찰적(연관적) 질문** → P(Y | X)
* **Level 2: 개입적(Interventional) 질문** → P(Y | do(X))
* **Level 3: 반사실적(Counterfactual) 질문** → P(Y\_x | X=x’)

> 예시:
>
> * 관찰적: 도시와 농촌 중 어디에 살고 있는 사람들의 생활수준이 더 높은가?
> * 개입적: 모든 도시와 농촌에 같은 조건으로 직업 훈련을 받으면 생활수준 차이가 없어질까?
> * 반사실적: 내가 다른 전공을 택했다면 어떤 직업을 가졌을까?

---

### 3. **연관과 인과의 차이: 심슨의 역설 (Simpson’s Paradox)**

> #### 사례: 신장결석 치료법 A vs B
>
> **전체 평균**으로 보면 B가 더 효과적이지만,
> **결석 크기별로 나누어** 보면 A가 더 효과적임.

* **관찰 자료**는 개인 특성(결석 크기 등)이 치료 선택에 영향을 주므로 왜곡될 수 있음.
* **무작위 배정**이 필요하거나, **적절한 보정**이 필요.

| Stone Size | Treatment A | Treatment B |
| ---------- | ----------- | ----------- |
| Small      | 93% success | 87% success |
| Large      | 73% success | 69% success |
| 전체         | 78%         | 83%         |

→ 전체 결과는 B가 좋아 보이지만, **모든 세부집단에서 A가 우수** → **혼란 변수(Confounder)** 존재.

---

### 4. **두 가지 주요 인과추론 프레임워크**

#### **1) 잠재 결과 프레임워크 (Potential Outcome, PO)**

* 개념: 각 개인은 **처리했을 경우 결과(Y(1))**, **하지 않았을 경우 결과(Y(0))** 두 개의 결과를 갖는다.
* 단점: 한 개인에 대해 **두 개의 결과를 동시에 관찰할 수 없음** → "missing data" 문제.
* 핵심 가정:

  * **SUTVA**: 서로 간섭 없음, 하나의 처리만 존재
  * **비혼란성(Unconfoundedness)**: 주어진 조건 Z 하에 X ⊥ (Y(1), Y(0))

> 예시:
>
> * A라는 환자가 약을 복용했을 때 혈압이 120 → Y(1) = 120
> * 만약 안 먹었으면 혈압이 140이었을지도 → Y(0) = 140
>   실제 관측은 단 하나만 가능 → Y(1) 또는 Y(0)만 본다.

#### **2) 구조적 인과 모형 (Structural Causal Model, SCM)**

* 각 변수는 어떤 함수로 결정된다:
  `X_i = f(PA_i, U_i)`

  * PA\_i는 선행 원인(parent), U\_i는 외생 변수.
* 이 모델은 **DAG (Directed Acyclic Graph)** 로 표현됨.
* **do(X=x)** 같은 \*\*개입(intervention)\*\*을 명확하게 표현 가능.

> 예시:
>
> * `BloodPressure = f(Smoking, Age, U)`
> * `do(Smoking=0)`은 해당 함수에서 흡연 변수를 강제로 0으로 고정함.

---

### 5. **SCM vs PO 비교 요약**

| 구분    | PO Framework   | SCM Framework |
| ----- | -------------- | ------------- |
| 모델 중심 | 통계적 추정         | 구조적 모델링       |
| 표현 방식 | 잠재 결과          | 인과 그래프        |
| 초점    | 추정량 정의 및 평균 효과 | 인과 구조 및 개입 표현 |
| 개입 표현 | Y(1), Y(0)     | do(X=x)       |

---

##  **Part II – 두 가지 주요 인과 추론 프레임워크**

### 1. **Stable Unit Treatment Value Assumption (SUTVA)**

* **SUTVA**는 두 가지 가정으로 구성된다

  1. **간섭 없음**(No interference): 한 개인의 처리 결과가 다른 개인에게 영향을 미치지 않아야함
  2. **처리의 일관성**(No different versions of a treatment): 동일한 처리에 대해 결과가 일관되어야함

* SUTVA는 **PO** 프레임워크에서 중요한 가정. 만약 이 가정이 성립하지 않으면, 표준 인과 추론 방법을 사용할 수 없다.

> 예시: 두 사람이 같은 병을 치료하지만, 각각 다른 방법(의사에 따라 치료법이 다름)으로 치료를 받는 경우, SUTVA가 위반

---

### 2. **랜덤화와 비혼란성(Unconfoundedness)**

* **랜덤화**가 이루어진 실험에서는, 처리 X가 **무작위로 배정**되어, **관측된 변수와 관측되지 않은 변수들에 대해 모두 균형**을 이룸
* 비혼란성(Unconfoundedness)은 관측된 변수 Z에 대해 X가 **무작위로 배정된 것**처럼 취급되는 상태를 의미. 즉, Z에 조건을 걸면, X와 Y 간의 상관관계가 원인-결과 관계를 정확히 반영하게 된다.

> 예시: 랜덤화된 실험에서 어떤 환자에게 약을 주고, 다른 환자에게는 위약을 준다. 이때, 약을 받는 그룹과 위약을 받는 그룹 사이에 기존 조건(예: 나이, 성별 등) 차이가 없으면, 그 차이가 치료 효과에 미친 영향을 정확하게 알 수 있다.

---

### 3. **잠재 결과(PO)에서의 주요 추정량**

* **평균 처리 효과 (ATE)**: 모든 사람에게 처리와 비처리 결과의 차이를 평균

  * $\tau = E[Y(1) - Y(0)]$
* **조건부 평균 처리 효과 (CATE)**: 특정 조건(Z)에 따라 처리 효과를 구함

  * $\tau(z) = E[Y(1) - Y(0) | Z = z]$
* **처리된 그룹의 평균 처리 효과 (ATT)**: 실제 처리된 그룹에서만 처리 효과를 구함

  * $\tau = E[Y(1) - Y(0) | X = 1]$

> 예시: 실험군과 대조군을 비교할 때, 실험군에 속한 사람들에게만 치료 효과를 계산하려면 ATT를 사용하고, 전체 사람들에 대한 평균을 계산하려면 ATE를 사용

---

### 4. **인과 추론에서의 주요 가정과 방법**

#### **비혼란성과 조건부 독립성 (Conditional Independence)**

* **비혼란성(Unconfoundedness)**: 처리 변수 X는 Z에 조건을 두었을 때, 결과 변수 Y(1)과 Y(0)에 독립적이어야. 즉, 주어진 Z에 대해 X가 Y에 미치는 영향을 제대로 추정할 수 있어야 한다.

* **조건부 독립성 (Conditional Independence)**: Z가 주어졌을 때, X와 Y는 서로 독립적이어야. 이는 특정 조건(Z)을 설정한 후, X와 Y 간의 관계가 인과적 해석을 가능하게 만듦.

#### **기법: 역확률 가중치(IPW)**

* 역확률 가중치(Inverse Probability Weighting, IPW)는 **확률 가중치**를 사용하여 표본을 **재조정**하여 평균 처리 효과(ATE)를 추정하는 방법.

  * 이 방법은 **처리 확률**에 따라 데이터를 가중하여, 비처리군을 비슷하게 맞추고 처치군의 효과를 보다 정확하게 추정할 수 있음

> 예시: 의료 실험에서 특정 약물의 효과를 분석할 때, 약물의 복용 여부를 랜덤화하지 않고, 환자의 선택에 따라 약물을 복용하게 한다면, IPW를 통해 환자 선택의 확률을 고려하여 처리 효과를 추정할 수 있다.

---

### 5. **두 가지 주요 인과 추론 프레임워크의 비교**

#### **PO Framework**

* PO는 잠재 결과에 초점을 맞추고, **누락된 데이터 문제**에 집중. 이 프레임워크에서는 **직접적인 개입**을 다루지 않고, "잠재적인 결과"를 비교.

#### **SCM (Structural Causal Model)**

* SCM은 **개입**(do-operator)을 명시적으로 다룬다. 각 변수 간의 **인과 관계**를 명확히 하고, 이 관계를 **DAG**(Directed Acyclic Graph)로 표현.
* SCM은 모델의 구조를 명확하게 정의하고, **실험적 개입**을 다루는 데 유리.

> 예시: PO 프레임워크는 "이 약을 먹었을 때 나을 확률"을 다루는 반면, SCM은 "이 약을 먹었을 때, 실제로 치료 효과를 얻을 수 있는지를 나타내는 그래프"를 그림

---

## **Part III – 다양한 인과 추론 방법**

### 1. **매칭 (Matching)**

* **목적**: 처리된 집단과 대조군 집단을 **유사한 특성을 가진 개체들**로 비교하여, **처리 효과**를 추정하는 방법
* **예시**: **NSW Job Training Program**에서, 훈련을 받은 사람들을 훈련을 받지 않은 사람들과 **매칭**하여, 훈련 효과를 추정

> 주요 방법:
>
> * **Propensity Score Matching**: 각 집단에 대해 처치 여부를 예측하는 확률을 구하고, 그 확률을 바탕으로 매칭

### 2. **도구 변수 (Instrumental Variables)**

* **목적**: **내생성**(Endogeneity)을 해결하기 위해, 외부에서 처치를 **조작할 수 있는 변수**를 사용하여 인과 관계를 추정하는 방법

> 예시: 약물이 효과가 있는지 알기 위해, 외부의 **기후 조건**을 도구 변수로 사용하여, 약물과 효과 간의 인과 관계를 추정

### 3. **회귀 불연속 설계 (Regression Discontinuity Design, RDD)**

* **목적**: 특정 임계값을 기준으로 처치 여부가 달라지는 경우에, 이 **불연속성**을 활용하여 처치의 효과를 추정

> 예시: **장학금**을 받는 기준이 시험 점수 90점 이상일 때, **90점**을 기준으로 두 집단을 비교하여 장학금 효과를 추정

### 4. **차이의 차이법 (Difference-in-Differences, DiD)**

* **목적**: **시간에 따른 변화**와 **처치 그룹**과 **비처치 그룹** 간의 변화를 비교하여 처리 효과를 추정

> 예시: **최저임금 인상**이 **고용에 미치는 영향**을 알아보기 위해, **최저임금을 인상한 지역**과 **인상하지 않은 지역**을 시간에 따라 비교하여 고용 변화를 추정

### 5. **합성 통제법 (Synthetic Control Method)**

* **목적**: 특정 지역이나 국가와 같은 단일 처리 단위에 대해, **가상의 통제군**을 만들어 **정책 변화나 이벤트의 영향**을 추정하는 방법

> 예시: **캘리포니아의 담배세 인상** 후, 그 효과를 추정하기 위해, **캘리포니아와 유사한 다른 주들**을 합성하여 비교

---

### 6. **각 방법의 특징 요약**

| 방법                 | 특징                                 |
| ------------------ | ---------------------------------- |
| **매칭**             | 처리군과 대조군을 유사한 특성에 맞춰 비교하여 처리 효과 추정 |
| **도구 변수**          | 외부 변수를 통해 내생성 문제 해결, 인과 관계 추정      |
| **회귀 불연속 설계(RDD)** | 특정 임계값을 기준으로 처리 효과 추정              |
| **차이의 차이법(DiD)**   | 시간과 집단 간 변화 비교하여 효과 추정             |
| **합성 통제법(SCM)**    | 가상의 통제군을 만들어 정책의 영향을 추정            |

---
